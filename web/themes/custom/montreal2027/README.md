# montreal2027 theme — Build & developer instructions

This theme uses Dart Sass to compile the SCSS source into a minified CSS bundle with an embedded source map.

Files and structure
- `src/scss/montreal2027.scss` — canonical SCSS source (edit this file).
- `css/montreal2027.min.css` — generated minified CSS (do not edit this file directly).
- `package.json` — includes the `sass` dev dependency and npm scripts for build/watch.

Build commands

1. Install dev tools (run once):

```bash
cd web/themes/custom/montreal2027
npm install
```

2. Build once (produces minified CSS with an embedded source map):

```bash
npm run build:css
```

This compiles `src/scss/montreal2027.scss` into `css/montreal2027.min.css` with `--style=compressed` and embeds the source map in the output (so DevTools can trace rules back to the SCSS).

3. Watch (development):

```bash
npm run watch:css
```

Notes on viewport units and fallbacks
- Modern browsers support `dvw` and `dvh` (dynamic viewport width/height). The SCSS intentionally uses `dvw`/`dvh` for better handling of browser UI changes (mobile URL bars, etc.).
- For broader compatibility the SCSS now provides fallbacks: it sets the legacy `vh`/`vw` first and then the modern `dvh`/`dvw`. Example (in SCSS):

```text
height: 100vh;
height: 100dvh;
```

That means older browsers will use `100vh` while modern browsers use `100dvh`.

Sourcemaps
- The build currently embeds the source map inside `montreal2027.min.css` (data URL). If you prefer an external `.map` file, change the build script in `package.json` to emit an external source map instead.

Drupal integration / cache
- After building the CSS, clear Drupal caches so the new CSS is picked up:

```bash
vendor/bin/drush cr
```

- If the embedded source map is not desired, change the build script in `package.json` to produce an external `.map` file.

Troubleshooting
- If you run into compilation errors, run `npm run build:css` locally and inspect the CLI output — it will point to the SCSS line with the error.
- If DevTools shows styles coming from a different file or an older CSS, ensure caches are cleared and that the active theme is `montreal2027`.
